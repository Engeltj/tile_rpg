<!DOCTYPE HTML>
<html>
<head>
	<script src="/socket.io/socket.io.js"></script>
	<script type="text/javascript" src="easeljs-0.7.1.min.js"></script>
	<script type="text/javascript">
		var canvas;
		var stage;
		var logo;
		var img;
		var text;
		var character;
		var bmpSeq;
		var spriteSheet;

		var rightHeld;
		var leftHeld;
		var keyDn = false;

		document.onkeydown=handleKeyDown;
		document.onkeyup=handleKeyUp;

		function init() {
			canvas = document.getElementById("game");
			stage = new createjs.Stage(canvas);

			// text = new createjs.Text("Text rendered!!!! ON CANVAS HELLO YOU", "36px Arial", "#666");
			// text.x = 100;
			// text.y = 100;

			character = new Image();
			character.src = "assets/character.png";
			spriteSheet = new createjs.SpriteSheet({
				images: [character],
				frames: {width:94, height:158},
				animations: {wkRight:[0,19, "wkRight"], wkUp:[20,39], wkDown:[40,59]}

			});

			console.log(spriteSheet);
			//createjs.SpriteSheetUtils.addFlippedFrames(spriteSheet, {wkLeft:["wkRight", true, false, "wkLeft"]});
			bmpSeq = new createjs.Sprite(spriteSheet);
			bmpSeq.regX = 94/2;
			bmpSeq.regY = 158;
			bmpSeq.gotoAndStop("wkRight");

			bmpSeq.x = canvas.width/2;
			bmpSeq.y = canvas.height/2;

			stage.addChild(bmpSeq);

			createjs.Ticker.addEventListener("tick", tick);
			// img = new Image();
			// img.src = "assets/cat.gif";
			// img.onload  = setImg;
			
		}

		function handleKeyDown(e){
			if (!e){var e = window.event;}
			switch(e.keyCode){
				case 37: bmpSeq.scaleX= -1;leftHeld = true; break;
				case 39: bmpSeq.scaleX= 1;rightHeld = true; break;
			}
		}

		function handleKeyUp(e){
			if (!e){var e = window.event;}
			switch(e.keyCode){
				case 37: bmpSeq.gotoAndStop("wkLeft"); keyDn=false; leftHeld = false; break;
				case 39: bmpSeq.gotoAndStop("wkRight"); keyDn=false; rightHeld = false; break;
			}
		}

		function setImg(event){
			// logo = new createjs.Bitmap(img);
			// logo.x = canvas.width - 400;
			// logo.y = canvas.height/2 - 100;

			//stage.addChild(logo);
			//stage.addChild(text);
			
		}

		function tick(event){
			//logo.x-=2;
			if (leftHeld)
				bmpSeq.x -= 5;
			else if (rightHeld)
				bmpSeq.x += 5;
			if (leftHeld && keyDn==false){
				bmpSeq.gotoAndPlay("wkLeft");
				keyDn=true;
			}
			if (rightHeld && keyDn==false){
				bmpSeq.gotoAndPlay("wkRight");
				keyDn=true;
			}
			stage.update();
		}
		//window.onload = function () {
		    // socket.on('temps', function (data) {
		    // });
			//setInterval(function(){updateChart()}, 500); 
		//}
	</script>
</head>
<body onLoad="init()">
	<canvas id="game" width="960" height="580"></canvas>
</body>
</html>
